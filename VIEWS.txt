-- TYPES OF VIEWS
--THERE ARE MAINLY 4 TYPES OF VIEWS


-- 1. SIMPLE VIEW (Based only on Customer table)

CREATE OR REPLACE VIEW vw_simple_customer AS
SELECT customer_id,customer_name,city
FROM customer;

SELECT * FROM vw_simple_customer;




-- 2. COMPLEX VIEW (Using JOIN + Aggregation)

CREATE OR REPLACE VIEW vw_complex_customer_orders AS
SELECT c.customer_id,c.customer_name,
COUNT(o.order_id) AS total_orders,
SUM(o.order_amount) AS total_purchase
FROM customer c
JOIN 
orders o ON c.customer_id = o.customer_id
GROUP BY c.customer_id, c.customer_name;

SELECT * FROM vw_complex_customer_orders;



-- 3. MATERIALIZED VIEW

CREATE MATERIALIZED VIEW LOG ON CUSTOMERS;

CREATE MATERIALIZED VIEW mv_customer_sales TABLESPACE TBS_DATA
REFRESH FAST ON COMMIT
AS
SELECT c.customer_id,c.customer_name,
    SUM(o.order_amount) AS total_sales
FROM customer c
JOIN orders o ON c.customer_id = o.customer_id
GROUP BY c.customer_id, c.customer_name;


-- 4. INLINE VIEW 

SELECT * FROM (
SELECT c.customer_id,c.customer_name,
AVG(o.order_amount) AS avg_order_amount
FROM customer c JOIN 
orders o ON c.customer_id = o.customer_id
GROUP BY c.customer_id, c.customer_name) inline_view
WHERE avg_order_amount > 500;




-- COMPLEX VIEW WITH ADVANCED SELECT LOGIC

CREATE OR REPLACE VIEW vw_customer_order_analysis AS
SELECT c.customer_id,c.customer_name,c.city,
COUNT(o.order_id) AS total_orders,
SUM(o.order_amount) AS total_amount_spent,
AVG(o.order_amount) AS average_order_value,
CASE 
WHEN SUM(o.order_amount) > 5000 THEN 'PLATINUM CUSTOMER'
WHEN SUM(o.order_amount) BETWEEN 2000 AND 5000 THEN 'GOLD CUSTOMER'
ELSE 'SILVER CUSTOMER'
END AS customer_category
FROM customer c
LEFT JOIN 
orders o ON c.customer_id = o.customer_id
GROUP BY 
c.customer_id, c.customer_name, c.city
HAVING 
    COUNT(o.order_id) > 0;
    
SELECT * FROM vw_customer_order_analysis; 




-- SECURE VIEW (Hides sensitive data)

CREATE OR REPLACE VIEW vw_customer_public AS
SELECT customer_id,customer_name,city
FROM customer;

SELECT * FROM vw_customer_public;





	
